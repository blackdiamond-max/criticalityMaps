<!DOCTYPE html>
<head>    
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <script>L_PREFER_CANVAS=false; L_NO_TOUCH=false; L_DISABLE_3D=false;</script>
    <script src="https://cdn.jsdelivr.net/npm/leaflet@1.5.0/dist/leaflet.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/leaflet-search@2.9.8/src/leaflet-search.js" integrity="sha256-qGIpIMlQBXdYwk0c6btx1RD6z3EJX5Y685QoJrMS2sE=" crossorigin="anonymous"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.5/d3.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet@1.5.0/dist/leaflet.css"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet-search@2.9.8/src/leaflet-search.css" integrity="sha256-shglAIJTG86aSEHQg3eLxymTGG0nMyMRXBwGplGN1jU=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap-theme.min.css"/>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.css"/>
    <link rel="stylesheet" href="https://rawcdn.githack.com/python-visualization/folium/master/folium/templates/leaflet.awesome.rotate.css"/>
    <style>html, body {width: 100%;height: 100%;margin: 0;padding: 0;}</style>
    <style>#map {position:absolute;top:0;bottom:0;right:0;left:0;}</style>    
    <style>#map {
        position: relative;
        width: 100.0%;
        height: 100.0%;
        left: 0.0%;
        top: 0.0%;
        }
    </style>    
</head>

<body>
    <div class="leaflet-map" id="map" >
        <svg>
            <defs>
                <rect id="myRect" width= 400 height=10 />
                <linearGradient id="myGradient">
                  <stop offset="5%" stop-color="blue" />
                  <stop offset="5%" stop-color="green" />
                  <stop offset="25%" stop-color="green" />
                  <stop offset="25%" stop-color="yellow" />
                  <stop offset="50%" stop-color="yellow" />
                  <stop offset="50%" stop-color="red" />
                </linearGradient>
            </defs>
        </svg>
    </div>
</body>

<script>    

    var bounds = null;

    var map = L.map(
        'map', {
        maxBounds: bounds,
        layers: [],
        worldCopyJump: false,
        crs: L.CRS.EPSG3857,
        zoomControl: true,
        });

    var tile_layer = L.tileLayer(
        'https://stamen-tiles-{s}.a.ssl.fastly.net/terrain/{z}/{x}/{y}.jpg',
        {
        "attribution": null,
        "detectRetina": false,
        "maxNativeZoom": 18,
        "maxZoom": 18,
        "minZoom": 0,
        "noWrap": false,
        "opacity": 1,
        "subdomains": "abc",
        "tms": false
        }
    ).addTo(map);
    
    var impact_layers = L.layerGroup().addTo(map);
        
    map.on('baselayerchange', function(e){
        impact_layers.clearLayers()
    });

    map.on('keydown', function(e){
        //alert(Object.entries(e.sourceTarget))
        var event = e.originalEvent
        if(event.key === 'Escape') {
            //alert(event.key)
            impact_layers.clearLayers()
        }
    });
        
    var nodeMarkerOptions = {
    radius: 3,
    fillColor: "#ff7800",
    color: "#000",
    weight: 1.5,
    opacity: 1,
    fillOpacity: 0.8
    };
    
    var linkStyle = {
    'bubblingMouseEvents': true,
    'fillOpacity': 0.8,
    'weight': 2,
    'color': 'black',
    'fillColor': 'black'
    };          
    
    var criticalityMarkerOptions = {
        bubblingMouseEvents: true,
        radius: 8,
        fillColor: "red",
        color: "black",
        weight: 3,
        opacity: .8,
        fillOpacity: 0.8
        };
    
    function tooltipBuilder(layer){
        // Convert non-primitive to String.
        let handleObject = (feature)=>typeof(feature)=='object' ? JSON.stringify(feature) : feature;
        var fields = this.options.tooltipFields;
        
        return '<table>' +
        String(
            fields.map(
            columnname=>
                `<tr style="text-align: left;">
                <th style="padding: 4px; padding-right: 10px;">
                ${ columnname}
                </th>

                <td style="padding: 4px;">${handleObject(layer.feature.properties[columnname])
                }</td></tr>`
            ).join(''))
            +'</table>'
    }
        
    function wnTooltipBuilder(layer){
        var fields = ["ID"];
        if(layer.feature.geometry.type === 'LineString'){
            fields.push('Pipe Diameter (in)')
        }else if (layer.feature.geometry.type === 'Point'){
            fields.push('Base Demand (gpm)')
        }
        try {
        tooltip = '<table>' +
                    String(
                        fields.map(
                        columnname=>
                            `<tr style="text-align: left;">
                            <th style="padding: 4px; padding-right: 10px;">
                            ${ columnname}
                            </th>

                            <td style="padding: 4px;">${layer.feature.properties[columnname]
                            }</td></tr>`
                        ).join(''))
                        +'</table>'
        }catch(e){
            alert(e.message)
        }
        return tooltip
    }
    
    function colorMapCriticality(popImpacted){
            var color = null;
            var radius = 5;
            var fillOpacity = 1;
            if (typeof(popImpacted) !== 'string'){
                if(popImpacted < 500) {
                    color = 'blue';
                    fillOpacity = 0.5;
                    radius = 2;
                }
                else if(popImpacted < 2500){
                    color = 'green';
                }
                else if(popImpacted < 5000){
                    color = 'yellow';
                }
                else if(popImpacted > 5000){
                    color = 'red';
                }
            }
            else if(popImpacted === 'SIMULATION FAILED'){
                radius = 0
            }
            else if(popImpacted === 'NO EFFECTED NODES'){
                radius = 0
            }
            var style = {
                bubblingMouseEvents: true,
                radius: radius,
                color: color,
                weight: 4,
                opacity: 1,
                fillOpacity: fillOpacity
            };
            return style;
        }
        
    function clickFunction(e) {
        impact_layers.clearLayers()
        var impact = e.target.feature.properties.impact;
        if(typeof(impact) === 'string'){
            if(impact === 'ALL NODES'){
                var nodes_impacted_layer = L.geoJson(wn,{
                    pointToLayer: function (feature, latlng) {
                    return L.circleMarker(latlng, criticalityMarkerOptions);
                    },
                    filter: function(feature){
                        properties = feature.properties;
                        if(properties.hasOwnProperty("Base Demand (gpm)") &&
                           feature.geometry.type === "Point") return true;
                    }
                }).addTo(impact_layers);

                nodes_impacted_layer.bindTooltip(wnTooltipBuilder, {"sticky": true})
                                    .bindPopup(wnTooltipBuilder);
            }
            else{
               alert(impact)
            }
        }
        else if(typeof(impact) === 'object'){
            try {
                var nodes_impacted = []
                for(var key in impact){
                    if(impact.hasOwnProperty(key)){
                        nodes_impacted.push(key)
                    }
                }
                var nodes_impacted_layer = L.geoJson(wn,{
                    pointToLayer: function (feature, latlng) {
                    return L.circleMarker(latlng, criticalityMarkerOptions);
                    },
                    filter: function(feature) {
                        if(nodes_impacted.includes(String(feature.id))&&
                           feature.geometry.type === "Point") return true;
                    }
                }).addTo(impact_layers);

                nodes_impacted_layer.bindTooltip(wnTooltipBuilder, {"sticky": true})
                                    .bindPopup(wnTooltipBuilder);
            } catch (e) {
                alert(e.message)
            }
        }
    }
            
    function onEachFeature(feature, layer) {
        layer.on({
            'click': clickFunction
        });
    }
    
    var wn = {'type': 'FeatureColllection', 'features': [{'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-100.12500012505254, 40.12499999763822]}, 'id': '10', 'properties': {'ID': '10', 'Base Demand (gpm)': 0.0}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.78730204662479, 40.02668860678038]}, 'id': '15', 'properties': {'ID': '15', 'Base Demand (gpm)': 1.0}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.88726277778879, 40.074337775189775]}, 'id': '20', 'properties': {'ID': '20', 'Base Demand (gpm)': 0.0}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.97811454369705, 39.93465598015845]}, 'id': '35', 'properties': {'ID': '35', 'Base Demand (gpm)': 1.0}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.9617313530654, 39.925021992882115]}, 'id': '40', 'properties': {'ID': '40', 'Base Demand (gpm)': 0.0}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.90983329331696, 39.85124252937452]}, 'id': '50', 'properties': {'ID': '50', 'Base Demand (gpm)': 0.0}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.94418594042622, 40.11316571005805]}, 'id': '60', 'properties': {'ID': '60', 'Base Demand (gpm)': 0.0}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.95597824513047, 40.110966420393474]}, 'id': '601', 'properties': {'ID': '601', 'Base Demand (gpm)': 0.0}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.94887198404082, 40.105345703911674]}, 'id': '61', 'properties': {'ID': '61', 'Base Demand (gpm)': 0.0}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-100.08157867117619, 40.07079050243796]}, 'id': '101', 'properties': {'ID': '101', 'Base Demand (gpm)': 189.95}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-100.09592666891868, 40.05782071615253]}, 'id': '103', 'properties': {'ID': '103', 'Base Demand (gpm)': 133.2}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-100.04889567126371, 40.04930200741969]}, 'id': '105', 'properties': {'ID': '105', 'Base Demand (gpm)': 135.37}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-100.03370951816913, 40.038850534896916]}, 'id': '107', 'properties': {'ID': '107', 'Base Demand (gpm)': 54.64}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-100.04734933848313, 40.026616700296934]}, 'id': '109', 'properties': {'ID': '109', 'Base Demand (gpm)': 231.4}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-100.0209000534726, 40.00877219390829]}, 'id': '111', 'properties': {'ID': '111', 'Base Demand (gpm)': 141.94}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-100.00188765775621, 39.99669174772947]}, 'id': '113', 'properties': {'ID': '113', 'Base Demand (gpm)': 20.01}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-100.00743333553403, 40.0220784684358]}, 'id': '115', 'properties': {'ID': '115', 'Base Demand (gpm)': 52.1}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.99345714780888, 40.03956907715838]}, 'id': '117', 'properties': {'ID': '117', 'Base Demand (gpm)': 117.71}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.96587228534635, 40.0487747605668]}, 'id': '119', 'properties': {'ID': '119', 'Base Demand (gpm)': 176.13}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.98398552580154, 40.055191797077164]}, 'id': '120', 'properties': {'ID': '120', 'Base Demand (gpm)': 0.0}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.96037762213122, 40.07383664922045]}, 'id': '121', 'properties': {'ID': '121', 'Base Demand (gpm)': 41.63}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.95750152746828, 40.090524970752085]}, 'id': '123', 'properties': {'ID': '123', 'Base Demand (gpm)': 1.0}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.94766463225, 40.07292798144283]}, 'id': '125', 'properties': {'ID': '125', 'Base Demand (gpm)': 45.6}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.89040253343143, 40.0700467067569]}, 'id': '127', 'properties': {'ID': '127', 'Base Demand (gpm)': 17.66}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.87833137287778, 40.067818263439854]}, 'id': '129', 'properties': {'ID': '129', 'Base Demand (gpm)': 0.0}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.78085875214838, 40.08057406874117]}, 'id': '131', 'properties': {'ID': '131', 'Base Demand (gpm)': 42.75}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.84857490966529, 40.044973212222665]}, 'id': '139', 'properties': {'ID': '139', 'Base Demand (gpm)': 5.89}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.82435429663278, 40.026805289629685]}, 'id': '141', 'properties': {'ID': '141', 'Base Demand (gpm)': 9.85}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.80635526140021, 40.01306140552471]}, 'id': '143', 'properties': {'ID': '143', 'Base Demand (gpm)': 6.2}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.86582164947461, 39.99813951858268]}, 'id': '145', 'properties': {'ID': '145', 'Base Demand (gpm)': 27.63}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.8955013939745, 40.01374838233397]}, 'id': '147', 'properties': {'ID': '147', 'Base Demand (gpm)': 8.55}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.90180706357019, 40.018283471565226]}, 'id': '149', 'properties': {'ID': '149', 'Base Demand (gpm)': 27.07}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.91566620664165, 40.02690739894619]}, 'id': '151', 'properties': {'ID': '151', 'Base Demand (gpm)': 144.48}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.91420087170205, 40.0384299427295]}, 'id': '153', 'properties': {'ID': '153', 'Base Demand (gpm)': 44.17}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.95936371401709, 40.022929080438246]}, 'id': '157', 'properties': {'ID': '157', 'Base Demand (gpm)': 51.79}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.98682215351899, 40.00249538333149]}, 'id': '159', 'properties': {'ID': '159', 'Base Demand (gpm)': 41.32}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.96955142743492, 39.97836514854069]}, 'id': '161', 'properties': {'ID': '161', 'Base Demand (gpm)': 15.800000000000002}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.96695530937815, 39.97505770562626]}, 'id': '163', 'properties': {'ID': '163', 'Base Demand (gpm)': 9.42}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.95960338072662, 39.97528167895033]}, 'id': '164', 'properties': {'ID': '164', 'Base Demand (gpm)': 0.0}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.95376444416203, 39.97415702605263]}, 'id': '166', 'properties': {'ID': '166', 'Base Demand (gpm)': 2.6}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.96658203993718, 39.95599228738351]}, 'id': '167', 'properties': {'ID': '167', 'Base Demand (gpm)': 14.56}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.96957258212068, 39.95423954911]}, 'id': '169', 'properties': {'ID': '169', 'Base Demand (gpm)': 0.0}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.9607226267161, 39.943749079616595]}, 'id': '171', 'properties': {'ID': '171', 'Base Demand (gpm)': 39.34}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.9587072102084, 39.94139854263818]}, 'id': '173', 'properties': {'ID': '173', 'Base Demand (gpm)': 0.0}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.97504896532949, 39.93459058156952]}, 'id': '177', 'properties': {'ID': '177', 'Base Demand (gpm)': 58.17}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.97550541954473, 39.93305610729094]}, 'id': '179', 'properties': {'ID': '179', 'Base Demand (gpm)': 0.0}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.97447523603206, 39.93610438321538]}, 'id': '181', 'properties': {'ID': '181', 'Base Demand (gpm)': 0.0}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.97914454467399, 39.93160767335487]}, 'id': '183', 'properties': {'ID': '183', 'Base Demand (gpm)': 0.0}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.98443332993399, 39.92627011115441]}, 'id': '184', 'properties': {'ID': '184', 'Base Demand (gpm)': 0.0}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.98567220611093, 39.927913334832546]}, 'id': '185', 'properties': {'ID': '185', 'Base Demand (gpm)': 25.65}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.99806114173452, 39.943109354255384]}, 'id': '187', 'properties': {'ID': '187', 'Base Demand (gpm)': 0.0}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.99119479738259, 39.94503501927267]}, 'id': '189', 'properties': {'ID': '189', 'Base Demand (gpm)': 107.92}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-100.0079983334622, 39.973639579695195]}, 'id': '191', 'properties': {'ID': '191', 'Base Demand (gpm)': 81.9}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.99809552155097, 39.97455712252069]}, 'id': '193', 'properties': {'ID': '193', 'Base Demand (gpm)': 71.31}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.99358261207202, 39.97727756584869]}, 'id': '195', 'properties': {'ID': '195', 'Base Demand (gpm)': 0.0}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-100.01828119117464, 39.98599088036898]}, 'id': '197', 'properties': {'ID': '197', 'Base Demand (gpm)': 17.04}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.93728213824866, 39.90768950130077]}, 'id': '199', 'properties': {'ID': '199', 'Base Demand (gpm)': 119.32}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.9197051646007, 39.90581723631007]}, 'id': '201', 'properties': {'ID': '201', 'Base Demand (gpm)': 44.61}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.91591410764323, 39.9081870467193]}, 'id': '203', 'properties': {'ID': '203', 'Base Demand (gpm)': 1.0}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.9965603240375, 39.94151524585893]}, 'id': '204', 'properties': {'ID': '204', 'Base Demand (gpm)': 0.0}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.94518286809199, 39.890274289669065]}, 'id': '205', 'properties': {'ID': '205', 'Base Demand (gpm)': 65.36}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.91587704632707, 39.886802616728765]}, 'id': '206', 'properties': {'ID': '206', 'Base Demand (gpm)': 0.0}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.92369009745623, 39.88789986776073]}, 'id': '207', 'properties': {'ID': '207', 'Base Demand (gpm)': 69.39}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.90510999318069, 39.886512022970905]}, 'id': '208', 'properties': {'ID': '208', 'Base Demand (gpm)': 0.0}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.89141081972137, 39.88199517936693]}, 'id': '209', 'properties': {'ID': '209', 'Base Demand (gpm)': 0.87}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.88908593564042, 39.87160608293155]}, 'id': '211', 'properties': {'ID': '211', 'Base Demand (gpm)': 8.67}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.87500005970713, 39.8749999993174]}, 'id': '213', 'properties': {'ID': '213', 'Base Demand (gpm)': 13.94}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.8131282011266, 39.88843327181121]}, 'id': '215', 'properties': {'ID': '215', 'Base Demand (gpm)': 92.19}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.78799260753088, 39.88338870492652]}, 'id': '217', 'properties': {'ID': '217', 'Base Demand (gpm)': 24.22}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.75402648848839, 39.88351144658127]}, 'id': '219', 'properties': {'ID': '219', 'Base Demand (gpm)': 41.32}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.77485855247039, 39.86878690335293]}, 'id': '225', 'properties': {'ID': '225', 'Base Demand (gpm)': 22.8}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.87165888036284, 39.84903567362922]}, 'id': '229', 'properties': {'ID': '229', 'Base Demand (gpm)': 64.18}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.8482329057062, 39.83584779916559]}, 'id': '231', 'properties': {'ID': '231', 'Base Demand (gpm)': 16.48}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.88201287152667, 39.84697668917426]}, 'id': '237', 'properties': {'ID': '237', 'Base Demand (gpm)': 15.61}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.87952163373772, 39.839217977468714]}, 'id': '239', 'properties': {'ID': '239', 'Base Demand (gpm)': 44.61}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.87877279630396, 39.83718464364796]}, 'id': '241', 'properties': {'ID': '241', 'Base Demand (gpm)': 0.0}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.87076414345465, 39.81571286546226]}, 'id': '243', 'properties': {'ID': '243', 'Base Demand (gpm)': 4.34}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.88888466758408, 39.83840819445018]}, 'id': '247', 'properties': {'ID': '247', 'Base Demand (gpm)': 70.38}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.88953094606137, 39.836242300289065]}, 'id': '249', 'properties': {'ID': '249', 'Base Demand (gpm)': 0.0}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.9016262705079, 39.83164028193637]}, 'id': '251', 'properties': {'ID': '251', 'Base Demand (gpm)': 24.16}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.92270785547748, 39.8427856004919]}, 'id': '253', 'properties': {'ID': '253', 'Base Demand (gpm)': 54.52}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.90548582620045, 39.84515153120389]}, 'id': '255', 'properties': {'ID': '255', 'Base Demand (gpm)': 40.39}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.99408375881995, 40.05905704786432]}, 'id': '257', 'properties': {'ID': '257', 'Base Demand (gpm)': 0.0}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.99821534628443, 40.06054306982967]}, 'id': '259', 'properties': {'ID': '259', 'Base Demand (gpm)': 0.0}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-100.00357039128293, 40.04296155510287]}, 'id': '261', 'properties': {'ID': '261', 'Base Demand (gpm)': 0.0}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-100.00876832391806, 40.045014666511825]}, 'id': '263', 'properties': {'ID': '263', 'Base Demand (gpm)': 0.0}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.97066358249455, 39.96260162945918]}, 'id': '265', 'properties': {'ID': '265', 'Base Demand (gpm)': 0.0}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.99598647093696, 39.960887316353784]}, 'id': '267', 'properties': {'ID': '267', 'Base Demand (gpm)': 0.0}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.97880746846332, 39.95016737510095]}, 'id': '269', 'properties': {'ID': '269', 'Base Demand (gpm)': 0.0}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.97084560021605, 39.9379343966691]}, 'id': '271', 'properties': {'ID': '271', 'Base Demand (gpm)': 0.0}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.94317889801965, 39.898660733940496]}, 'id': '273', 'properties': {'ID': '273', 'Base Demand (gpm)': 0.0}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.9183494082251, 39.90291709960106]}, 'id': '275', 'properties': {'ID': '275', 'Base Demand (gpm)': 0.0}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.93822713224003, 40.122756631825546]}, 'id': 'River', 'properties': {'ID': 'River', 'Base Demand (gpm)': 'Reservoir'}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-100.13761729086816, 40.124161200816]}, 'id': 'Lake', 'properties': {'ID': 'Lake', 'Base Demand (gpm)': 'Reservoir'}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.9564925632005, 39.92438256168259]}, 'id': '1', 'properties': {'ID': '1', 'Base Demand (gpm)': 'Tank'}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.90888354870238, 39.855254997793665]}, 'id': '2', 'properties': {'ID': '2', 'Base Demand (gpm)': 'Tank'}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.88664249880316, 40.077648772491486]}, 'id': '3', 'properties': {'ID': '3', 'Base Demand (gpm)': 'Tank'}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.88664249880316, 40.077648772491486], [-99.88726277778879, 40.074337775189775]]}, 'id': '20', 'properties': {'ID': '20', 'Pipe Diameter (in)': 99}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.9564925632005, 39.92438256168259], [-99.9617313530654, 39.925021992882115]]}, 'id': '40', 'properties': {'ID': '40', 'Pipe Diameter (in)': 99}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.90888354870238, 39.855254997793665], [-99.90983329331696, 39.85124252937452]]}, 'id': '50', 'properties': {'ID': '50', 'Pipe Diameter (in)': 99}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.93822713224003, 40.122756631825546], [-99.94418594042622, 40.11316571005805]]}, 'id': '60', 'properties': {'ID': '60', 'Pipe Diameter (in)': 24}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-100.12500012505254, 40.12499999763822], [-100.08157867117619, 40.07079050243796]]}, 'id': '101', 'properties': {'ID': '101', 'Pipe Diameter (in)': 18}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-100.08157867117619, 40.07079050243796], [-100.09592666891868, 40.05782071615253]]}, 'id': '103', 'properties': {'ID': '103', 'Pipe Diameter (in)': 16}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-100.08157867117619, 40.07079050243796], [-100.04889567126371, 40.04930200741969]]}, 'id': '105', 'properties': {'ID': '105', 'Pipe Diameter (in)': 12}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-100.04889567126371, 40.04930200741969], [-100.03370951816913, 40.038850534896916]]}, 'id': '107', 'properties': {'ID': '107', 'Pipe Diameter (in)': 12}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-100.09592666891868, 40.05782071615253], [-100.04734933848313, 40.026616700296934]]}, 'id': '109', 'properties': {'ID': '109', 'Pipe Diameter (in)': 16}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-100.04734933848313, 40.026616700296934], [-100.0209000534726, 40.00877219390829]]}, 'id': '111', 'properties': {'ID': '111', 'Pipe Diameter (in)': 12}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-100.00743333553403, 40.0220784684358], [-100.0209000534726, 40.00877219390829]]}, 'id': '112', 'properties': {'ID': '112', 'Pipe Diameter (in)': 12}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-100.0209000534726, 40.00877219390829], [-100.00188765775621, 39.99669174772947]]}, 'id': '113', 'properties': {'ID': '113', 'Pipe Diameter (in)': 12}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-100.00743333553403, 40.0220784684358], [-100.00188765775621, 39.99669174772947]]}, 'id': '114', 'properties': {'ID': '114', 'Pipe Diameter (in)': 8}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-100.03370951816913, 40.038850534896916], [-100.00743333553403, 40.0220784684358]]}, 'id': '115', 'properties': {'ID': '115', 'Pipe Diameter (in)': 8}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-100.00188765775621, 39.99669174772947], [-99.99809552155097, 39.97455712252069]]}, 'id': '116', 'properties': {'ID': '116', 'Pipe Diameter (in)': 12}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-100.00876832391806, 40.045014666511825], [-100.04889567126371, 40.04930200741969]]}, 'id': '117', 'properties': {'ID': '117', 'Pipe Diameter (in)': 12}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-100.00743333553403, 40.0220784684358], [-99.99345714780888, 40.03956907715838]]}, 'id': '119', 'properties': {'ID': '119', 'Pipe Diameter (in)': 12}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.96587228534635, 40.0487747605668], [-99.98398552580154, 40.055191797077164]]}, 'id': '120', 'properties': {'ID': '120', 'Pipe Diameter (in)': 12}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.98398552580154, 40.055191797077164], [-99.99345714780888, 40.03956907715838]]}, 'id': '121', 'properties': {'ID': '121', 'Pipe Diameter (in)': 12}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.96037762213122, 40.07383664922045], [-99.98398552580154, 40.055191797077164]]}, 'id': '122', 'properties': {'ID': '122', 'Pipe Diameter (in)': 8}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.96037762213122, 40.07383664922045], [-99.96587228534635, 40.0487747605668]]}, 'id': '123', 'properties': {'ID': '123', 'Pipe Diameter (in)': 30}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.95750152746828, 40.090524970752085], [-99.96037762213122, 40.07383664922045]]}, 'id': '125', 'properties': {'ID': '125', 'Pipe Diameter (in)': 30}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.96037762213122, 40.07383664922045], [-99.94766463225, 40.07292798144283]]}, 'id': '129', 'properties': {'ID': '129', 'Pipe Diameter (in)': 24}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.94766463225, 40.07292798144283], [-99.89040253343143, 40.0700467067569]]}, 'id': '131', 'properties': {'ID': '131', 'Pipe Diameter (in)': 24}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.88726277778879, 40.074337775189775], [-99.89040253343143, 40.0700467067569]]}, 'id': '133', 'properties': {'ID': '133', 'Pipe Diameter (in)': 20}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.89040253343143, 40.0700467067569], [-99.87833137287778, 40.067818263439854]]}, 'id': '135', 'properties': {'ID': '135', 'Pipe Diameter (in)': 24}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.87833137287778, 40.067818263439854], [-99.78085875214838, 40.08057406874117]]}, 'id': '137', 'properties': {'ID': '137', 'Pipe Diameter (in)': 16}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.87833137287778, 40.067818263439854], [-99.84857490966529, 40.044973212222665]]}, 'id': '145', 'properties': {'ID': '145', 'Pipe Diameter (in)': 8}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.84857490966529, 40.044973212222665], [-99.82435429663278, 40.026805289629685]]}, 'id': '147', 'properties': {'ID': '147', 'Pipe Diameter (in)': 8}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.80635526140021, 40.01306140552471], [-99.82435429663278, 40.026805289629685]]}, 'id': '149', 'properties': {'ID': '149', 'Pipe Diameter (in)': 8}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.78730204662479, 40.02668860678038], [-99.80635526140021, 40.01306140552471]]}, 'id': '151', 'properties': {'ID': '151', 'Pipe Diameter (in)': 8}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.86582164947461, 39.99813951858268], [-99.82435429663278, 40.026805289629685]]}, 'id': '153', 'properties': {'ID': '153', 'Pipe Diameter (in)': 12}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.8955013939745, 40.01374838233397], [-99.86582164947461, 39.99813951858268]]}, 'id': '155', 'properties': {'ID': '155', 'Pipe Diameter (in)': 12}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.8955013939745, 40.01374838233397], [-99.90180706357019, 40.018283471565226]]}, 'id': '159', 'properties': {'ID': '159', 'Pipe Diameter (in)': 12}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.90180706357019, 40.018283471565226], [-99.91566620664165, 40.02690739894619]]}, 'id': '161', 'properties': {'ID': '161', 'Pipe Diameter (in)': 8}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.91566620664165, 40.02690739894619], [-99.91420087170205, 40.0384299427295]]}, 'id': '163', 'properties': {'ID': '163', 'Pipe Diameter (in)': 12}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.94766463225, 40.07292798144283], [-99.91420087170205, 40.0384299427295]]}, 'id': '169', 'properties': {'ID': '169', 'Pipe Diameter (in)': 8}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.96587228534635, 40.0487747605668], [-99.91566620664165, 40.02690739894619]]}, 'id': '171', 'properties': {'ID': '171', 'Pipe Diameter (in)': 12}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.96587228534635, 40.0487747605668], [-99.95936371401709, 40.022929080438246]]}, 'id': '173', 'properties': {'ID': '173', 'Pipe Diameter (in)': 30}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.95936371401709, 40.022929080438246], [-99.98682215351899, 40.00249538333149]]}, 'id': '175', 'properties': {'ID': '175', 'Pipe Diameter (in)': 30}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.98682215351899, 40.00249538333149], [-99.96955142743492, 39.97836514854069]]}, 'id': '177', 'properties': {'ID': '177', 'Pipe Diameter (in)': 30}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.96955142743492, 39.97836514854069], [-99.96695530937815, 39.97505770562626]]}, 'id': '179', 'properties': {'ID': '179', 'Pipe Diameter (in)': 30}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.96695530937815, 39.97505770562626], [-99.95960338072662, 39.97528167895033]]}, 'id': '180', 'properties': {'ID': '180', 'Pipe Diameter (in)': 14}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.95960338072662, 39.97528167895033], [-99.95376444416203, 39.97415702605263]]}, 'id': '181', 'properties': {'ID': '181', 'Pipe Diameter (in)': 14}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.97066358249455, 39.96260162945918], [-99.96957258212068, 39.95423954911]]}, 'id': '183', 'properties': {'ID': '183', 'Pipe Diameter (in)': 30}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.96658203993718, 39.95599228738351], [-99.96957258212068, 39.95423954911]]}, 'id': '185', 'properties': {'ID': '185', 'Pipe Diameter (in)': 8}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.99806114173452, 39.943109354255384], [-99.9965603240375, 39.94151524585893]]}, 'id': '186', 'properties': {'ID': '186', 'Pipe Diameter (in)': 8}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.96957258212068, 39.95423954911], [-99.9607226267161, 39.943749079616595]]}, 'id': '187', 'properties': {'ID': '187', 'Pipe Diameter (in)': 30}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.9607226267161, 39.943749079616595], [-99.9587072102084, 39.94139854263818]]}, 'id': '189', 'properties': {'ID': '189', 'Pipe Diameter (in)': 30}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.97084560021605, 39.9379343966691], [-99.9607226267161, 39.943749079616595]]}, 'id': '191', 'properties': {'ID': '191', 'Pipe Diameter (in)': 24}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.97811454369705, 39.93465598015845], [-99.97447523603206, 39.93610438321538]]}, 'id': '193', 'properties': {'ID': '193', 'Pipe Diameter (in)': 24}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.97447523603206, 39.93610438321538], [-99.97504896532949, 39.93459058156952]]}, 'id': '195', 'properties': {'ID': '195', 'Pipe Diameter (in)': 12}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.97504896532949, 39.93459058156952], [-99.97550541954473, 39.93305610729094]]}, 'id': '197', 'properties': {'ID': '197', 'Pipe Diameter (in)': 12}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.97550541954473, 39.93305610729094], [-99.97914454467399, 39.93160767335487]]}, 'id': '199', 'properties': {'ID': '199', 'Pipe Diameter (in)': 12}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.9617313530654, 39.925021992882115], [-99.97550541954473, 39.93305610729094]]}, 'id': '201', 'properties': {'ID': '201', 'Pipe Diameter (in)': 12}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.98567220611093, 39.927913334832546], [-99.98443332993399, 39.92627011115441]]}, 'id': '202', 'properties': {'ID': '202', 'Pipe Diameter (in)': 8}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.97914454467399, 39.93160767335487], [-99.98567220611093, 39.927913334832546]]}, 'id': '203', 'properties': {'ID': '203', 'Pipe Diameter (in)': 8}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.98443332993399, 39.92627011115441], [-99.94518286809199, 39.890274289669065]]}, 'id': '204', 'properties': {'ID': '204', 'Pipe Diameter (in)': 12}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.9965603240375, 39.94151524585893], [-99.98567220611093, 39.927913334832546]]}, 'id': '205', 'properties': {'ID': '205', 'Pipe Diameter (in)': 12}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.99119479738259, 39.94503501927267], [-99.97914454467399, 39.93160767335487]]}, 'id': '207', 'properties': {'ID': '207', 'Pipe Diameter (in)': 12}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.99119479738259, 39.94503501927267], [-99.99806114173452, 39.943109354255384]]}, 'id': '209', 'properties': {'ID': '209', 'Pipe Diameter (in)': 8}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.96957258212068, 39.95423954911], [-99.97880746846332, 39.95016737510095]]}, 'id': '211', 'properties': {'ID': '211', 'Pipe Diameter (in)': 12}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-100.0079983334622, 39.973639579695195], [-99.99806114173452, 39.943109354255384]]}, 'id': '213', 'properties': {'ID': '213', 'Pipe Diameter (in)': 12}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.99598647093696, 39.960887316353784], [-99.99119479738259, 39.94503501927267]]}, 'id': '215', 'properties': {'ID': '215', 'Pipe Diameter (in)': 12}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-100.0079983334622, 39.973639579695195], [-99.99809552155097, 39.97455712252069]]}, 'id': '217', 'properties': {'ID': '217', 'Pipe Diameter (in)': 12}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.99809552155097, 39.97455712252069], [-99.99358261207202, 39.97727756584869]]}, 'id': '219', 'properties': {'ID': '219', 'Pipe Diameter (in)': 12}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.96955142743492, 39.97836514854069], [-99.99358261207202, 39.97727756584869]]}, 'id': '221', 'properties': {'ID': '221', 'Pipe Diameter (in)': 8}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-100.01828119117464, 39.98599088036898], [-100.0079983334622, 39.973639579695195]]}, 'id': '223', 'properties': {'ID': '223', 'Pipe Diameter (in)': 12}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-100.0209000534726, 40.00877219390829], [-100.01828119117464, 39.98599088036898]]}, 'id': '225', 'properties': {'ID': '225', 'Pipe Diameter (in)': 12}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.9587072102084, 39.94139854263818], [-99.93728213824866, 39.90768950130077]]}, 'id': '229', 'properties': {'ID': '229', 'Pipe Diameter (in)': 24}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.93728213824866, 39.90768950130077], [-99.9197051646007, 39.90581723631007]]}, 'id': '231', 'properties': {'ID': '231', 'Pipe Diameter (in)': 24}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.9197051646007, 39.90581723631007], [-99.91591410764323, 39.9081870467193]]}, 'id': '233', 'properties': {'ID': '233', 'Pipe Diameter (in)': 24}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.93728213824866, 39.90768950130077], [-99.94317889801965, 39.898660733940496]]}, 'id': '235', 'properties': {'ID': '235', 'Pipe Diameter (in)': 12}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.94518286809199, 39.890274289669065], [-99.92369009745623, 39.88789986776073]]}, 'id': '237', 'properties': {'ID': '237', 'Pipe Diameter (in)': 12}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.92369009745623, 39.88789986776073], [-99.91587704632707, 39.886802616728765]]}, 'id': '238', 'properties': {'ID': '238', 'Pipe Diameter (in)': 12}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.9183494082251, 39.90291709960106], [-99.92369009745623, 39.88789986776073]]}, 'id': '239', 'properties': {'ID': '239', 'Pipe Diameter (in)': 12}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.91587704632707, 39.886802616728765], [-99.90510999318069, 39.886512022970905]]}, 'id': '240', 'properties': {'ID': '240', 'Pipe Diameter (in)': 12}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.90510999318069, 39.886512022970905], [-99.89141081972137, 39.88199517936693]]}, 'id': '241', 'properties': {'ID': '241', 'Pipe Diameter (in)': 12}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.89141081972137, 39.88199517936693], [-99.88908593564042, 39.87160608293155]]}, 'id': '243', 'properties': {'ID': '243', 'Pipe Diameter (in)': 16}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.88908593564042, 39.87160608293155], [-99.87500005970713, 39.8749999993174]]}, 'id': '245', 'properties': {'ID': '245', 'Pipe Diameter (in)': 16}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.87500005970713, 39.8749999993174], [-99.8131282011266, 39.88843327181121]]}, 'id': '247', 'properties': {'ID': '247', 'Pipe Diameter (in)': 16}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.8131282011266, 39.88843327181121], [-99.78799260753088, 39.88338870492652]]}, 'id': '249', 'properties': {'ID': '249', 'Pipe Diameter (in)': 16}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.78799260753088, 39.88338870492652], [-99.75402648848839, 39.88351144658127]]}, 'id': '251', 'properties': {'ID': '251', 'Pipe Diameter (in)': 14}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.78799260753088, 39.88338870492652], [-99.77485855247039, 39.86878690335293]]}, 'id': '257', 'properties': {'ID': '257', 'Pipe Diameter (in)': 12}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.87500005970713, 39.8749999993174], [-99.87165888036284, 39.84903567362922]]}, 'id': '261', 'properties': {'ID': '261', 'Pipe Diameter (in)': 8}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.87165888036284, 39.84903567362922], [-99.8482329057062, 39.83584779916559]]}, 'id': '263', 'properties': {'ID': '263', 'Pipe Diameter (in)': 12}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.88908593564042, 39.87160608293155], [-99.88201287152667, 39.84697668917426]]}, 'id': '269', 'properties': {'ID': '269', 'Pipe Diameter (in)': 12}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.88201287152667, 39.84697668917426], [-99.87165888036284, 39.84903567362922]]}, 'id': '271', 'properties': {'ID': '271', 'Pipe Diameter (in)': 8}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.88201287152667, 39.84697668917426], [-99.87952163373772, 39.839217977468714]]}, 'id': '273', 'properties': {'ID': '273', 'Pipe Diameter (in)': 12}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.87952163373772, 39.839217977468714], [-99.87877279630396, 39.83718464364796]]}, 'id': '275', 'properties': {'ID': '275', 'Pipe Diameter (in)': 12}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.87877279630396, 39.83718464364796], [-99.87076414345465, 39.81571286546226]]}, 'id': '277', 'properties': {'ID': '277', 'Pipe Diameter (in)': 12}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.87877279630396, 39.83718464364796], [-99.88888466758408, 39.83840819445018]]}, 'id': '281', 'properties': {'ID': '281', 'Pipe Diameter (in)': 10}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.87952163373772, 39.839217977468714], [-99.88953094606137, 39.836242300289065]]}, 'id': '283', 'properties': {'ID': '283', 'Pipe Diameter (in)': 12}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.88888466758408, 39.83840819445018], [-99.88953094606137, 39.836242300289065]]}, 'id': '285', 'properties': {'ID': '285', 'Pipe Diameter (in)': 12}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.88888466758408, 39.83840819445018], [-99.90548582620045, 39.84515153120389]]}, 'id': '287', 'properties': {'ID': '287', 'Pipe Diameter (in)': 10}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.90983329331696, 39.85124252937452], [-99.90548582620045, 39.84515153120389]]}, 'id': '289', 'properties': {'ID': '289', 'Pipe Diameter (in)': 10}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.90548582620045, 39.84515153120389], [-99.92270785547748, 39.8427856004919]]}, 'id': '291', 'properties': {'ID': '291', 'Pipe Diameter (in)': 10}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.90548582620045, 39.84515153120389], [-99.9016262705079, 39.83164028193637]]}, 'id': '293', 'properties': {'ID': '293', 'Pipe Diameter (in)': 8}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.88953094606137, 39.836242300289065], [-99.9016262705079, 39.83164028193637]]}, 'id': '295', 'properties': {'ID': '295', 'Pipe Diameter (in)': 12}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.98398552580154, 40.055191797077164], [-99.99408375881995, 40.05905704786432]]}, 'id': '297', 'properties': {'ID': '297', 'Pipe Diameter (in)': 8}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.99408375881995, 40.05905704786432], [-99.99821534628443, 40.06054306982967]]}, 'id': '299', 'properties': {'ID': '299', 'Pipe Diameter (in)': 8}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.99821534628443, 40.06054306982967], [-100.00876832391806, 40.045014666511825]]}, 'id': '301', 'properties': {'ID': '301', 'Pipe Diameter (in)': 8}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.99408375881995, 40.05905704786432], [-100.00357039128293, 40.04296155510287]]}, 'id': '303', 'properties': {'ID': '303', 'Pipe Diameter (in)': 8}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.99345714780888, 40.03956907715838], [-100.00357039128293, 40.04296155510287]]}, 'id': '305', 'properties': {'ID': '305', 'Pipe Diameter (in)': 12}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-100.00357039128293, 40.04296155510287], [-100.00876832391806, 40.045014666511825]]}, 'id': '307', 'properties': {'ID': '307', 'Pipe Diameter (in)': 12}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.97066358249455, 39.96260162945918], [-99.99598647093696, 39.960887316353784]]}, 'id': '309', 'properties': {'ID': '309', 'Pipe Diameter (in)': 8}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.99809552155097, 39.97455712252069], [-99.99598647093696, 39.960887316353784]]}, 'id': '311', 'properties': {'ID': '311', 'Pipe Diameter (in)': 12}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.97880746846332, 39.95016737510095], [-99.99119479738259, 39.94503501927267]]}, 'id': '313', 'properties': {'ID': '313', 'Pipe Diameter (in)': 12}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.97447523603206, 39.93610438321538], [-99.97084560021605, 39.9379343966691]]}, 'id': '315', 'properties': {'ID': '315', 'Pipe Diameter (in)': 24}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.94317889801965, 39.898660733940496], [-99.9183494082251, 39.90291709960106]]}, 'id': '317', 'properties': {'ID': '317', 'Pipe Diameter (in)': 8}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.94317889801965, 39.898660733940496], [-99.94518286809199, 39.890274289669065]]}, 'id': '319', 'properties': {'ID': '319', 'Pipe Diameter (in)': 12}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.96695530937815, 39.97505770562626], [-99.97066358249455, 39.96260162945918]]}, 'id': '321', 'properties': {'ID': '321', 'Pipe Diameter (in)': 30}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.9197051646007, 39.90581723631007], [-99.9183494082251, 39.90291709960106]]}, 'id': '323', 'properties': {'ID': '323', 'Pipe Diameter (in)': 12}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.97880746846332, 39.95016737510095], [-99.97084560021605, 39.9379343966691]]}, 'id': '325', 'properties': {'ID': '325', 'Pipe Diameter (in)': 8}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.94887198404082, 40.105345703911674], [-99.95750152746828, 40.090524970752085]]}, 'id': '329', 'properties': {'ID': '329', 'Pipe Diameter (in)': 30}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.94418594042622, 40.11316571005805], [-99.95597824513047, 40.110966420393474]]}, 'id': '330', 'properties': {'ID': '330', 'Pipe Diameter (in)': 30}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.95597824513047, 40.110966420393474], [-99.94887198404082, 40.105345703911674]]}, 'id': '333', 'properties': {'ID': '333', 'Pipe Diameter (in)': 30}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-100.13761729086816, 40.124161200816], [-100.12500012505254, 40.12499999763822]]}, 'id': '10', 'properties': {'ID': '10', 'Pipe Diameter (in)': 'Pump'}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.94418594042622, 40.11316571005805], [-99.94887198404082, 40.105345703911674]]}, 'id': '335', 'properties': {'ID': '335', 'Pipe Diameter (in)': 'Pump'}}]}
    var wnGeojsonLayer = L.geoJson(wn, {
        pointToLayer: function (feature, latlng) {
            return L.circleMarker(latlng, nodeMarkerOptions) 
        },
        style: function(feature){
            return nodeMarkerOptions;
        }
    }).bindTooltip(wnTooltipBuilder, {"sticky": true})
    .bindPopup(wnTooltipBuilder, {"sticky": true});
    wnGeojsonLayer.addTo(map);
    map.fitBounds(wnGeojsonLayer.getBounds())
    
    var dataLayers = {}
            var PipeCriticality = L.geoJson({'type': 'FeatureColllection', 'features': [{'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-100.08157867117619, 40.07079050243796]}, 'properties': {'ID': '101', 'impact': 'NO EFFECTED NODES', 'Base Demand (gpm)': 189.95, 'Nodes Impacted': 'NO EFFECTED NODES', 'Population Impacted': 'NO EFFECTED NODES'}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-100.09592666891868, 40.05782071615253]}, 'properties': {'ID': '103', 'impact': 'NO EFFECTED NODES', 'Base Demand (gpm)': 133.2, 'Nodes Impacted': 'NO EFFECTED NODES', 'Population Impacted': 'NO EFFECTED NODES'}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-100.04734933848313, 40.026616700296934]}, 'properties': {'ID': '109', 'impact': 'NO EFFECTED NODES', 'Base Demand (gpm)': 231.4, 'Nodes Impacted': 'NO EFFECTED NODES', 'Population Impacted': 'NO EFFECTED NODES'}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.95750152746828, 40.090524970752085]}, 'properties': {'ID': '123', 'impact': {'101': '5.977755233418414', '103': '5.64906986584581', '105': '10.275026786771813', '107': '12.238071495945746', '109': '12.498321364609447', '153': '11.23438013960946', '185': '12.906212589167609', '191': '10.554193665783163', '193': '12.687790677081786', '197': '11.27117305524606', '205': '10.54861826250475', '229': '13.579578452085846', '237': '12.516075692631755', '239': '12.820875692631754', '243': '12.516075692631755', '247': '11.296875692631755', '251': '7.639275692631754', '253': '5.810475692631753', '255': '8.553675692631755', '35': '14.045402438581961'}, 'Base Demand (gpm)': 1.0, 'Nodes Impacted': 20, 'Population Impacted': 22908.0}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.94766463225, 40.07292798144283]}, 'properties': {'ID': '125', 'impact': {'101': '0.0', '103': '0.0', '105': '0.0', '107': '0.0', '109': '0.0', '111': '0.0', '113': '0.0', '115': '0.0', '117': '0.0', '119': '0.0', '121': '0.0', '125': '0.0', '127': '-0.7686267926313306', '131': '0.0', '139': '0.0', '141': '0.0', '143': '0.0', '145': '0.0', '147': '0.0', '149': '0.0', '15': '0.0', '151': '0.0', '153': '-3.881397151159039', '157': '0.0', '159': '0.0', '161': '0.0', '163': '0.0', '166': '0.0', '167': '0.0', '171': '0.0', '177': '0.0', '185': '0.0', '189': '0.0', '191': '0.0', '193': '0.0', '197': '0.0', '199': '0.0', '201': '0.0', '203': '0.0', '205': '0.0', '207': '0.0', '209': '0.0', '211': '0.0', '213': '0.0', '215': '0.0', '217': '0.0', '219': '0.0', '225': '0.0', '229': '0.0', '231': '0.0', '237': '0.0', '239': '0.0', '243': '0.0', '247': '0.0', '251': '0.0', '253': '0.0', '255': '0.0', '35': '0.0'}, 'Base Demand (gpm)': 45.6, 'Nodes Impacted': 58, 'Population Impacted': 70236.0}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.87833137287778, 40.067818263439854]}, 'properties': {'ID': '129', 'impact': 'NO EFFECTED NODES', 'Base Demand (gpm)': 0.0, 'Nodes Impacted': 'NO EFFECTED NODES', 'Population Impacted': 'NO EFFECTED NODES'}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.78085875214838, 40.08057406874117]}, 'properties': {'ID': '131', 'impact': 'NO EFFECTED NODES', 'Base Demand (gpm)': 42.75, 'Nodes Impacted': 'NO EFFECTED NODES', 'Population Impacted': 'NO EFFECTED NODES'}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.88726277778879, 40.074337775189775], [-99.89040253343143, 40.0700467067569]]}, 'properties': {'ID': '133', 'impact': 'NO EFFECTED NODES', 'Pipe Diameter (in)': 20.0, 'Nodes Impacted': 'NO EFFECTED NODES', 'Population Impacted': 'NO EFFECTED NODES'}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.89040253343143, 40.0700467067569], [-99.87833137287778, 40.067818263439854]]}, 'properties': {'ID': '135', 'impact': 'NO EFFECTED NODES', 'Pipe Diameter (in)': 24.0, 'Nodes Impacted': 'NO EFFECTED NODES', 'Population Impacted': 'NO EFFECTED NODES'}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.87833137287778, 40.067818263439854], [-99.78085875214838, 40.08057406874117]]}, 'properties': {'ID': '137', 'impact': {'131': '0.0'}, 'Pipe Diameter (in)': 16.0, 'Nodes Impacted': 1, 'Population Impacted': 329.0}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.9587072102084, 39.94139854263818]}, 'properties': {'ID': '173', 'impact': {'157': '13.306649160549153', '185': '13.005165223607715', '205': '10.212149853130047', '207': '13.770736821089999', '225': '14.024818222658771', '229': '13.275721750503267', '237': '12.21092403074287', '239': '12.515724030742868', '243': '12.21092403074287', '247': '10.99172403074287', '251': '7.334124030742869', '253': '5.505324030742868', '255': '8.24852403074287', '35': '13.48621066709831'}, 'Base Demand (gpm)': 0.0, 'Nodes Impacted': 14, 'Population Impacted': 16631.0}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.95936371401709, 40.022929080438246], [-99.98682215351899, 40.00249538333149]]}, 'properties': {'ID': '175', 'impact': {'185': '12.979080703682992', '205': '10.196498752821476', '207': '13.756166558201242', '225': '14.011603207431472', '229': '13.262168139568518', '237': '12.197321787944226', '239': '12.502121787944224', '243': '12.197321787944226', '247': '10.978121787944225', '251': '7.320521787944225', '253': '5.491721787944224', '255': '8.234921787944225', '35': '13.464876727894202'}, 'Pipe Diameter (in)': 30.0, 'Nodes Impacted': 13, 'Population Impacted': 16232.0}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.97504896532949, 39.93459058156952]}, 'properties': {'ID': '177', 'impact': {'185': '13.003330246488801', '205': '10.219648572312085', '207': '13.778219554019975', '225': '14.031608434909804', '229': '13.282685086382957', '237': '12.217912167435983', '239': '12.522712167435982', '243': '12.217912167435983', '247': '10.998712167435983', '251': '7.341112167435982', '253': '5.512312167435981', '255': '8.255512167435983', '35': '13.498554102374149'}, 'Base Demand (gpm)': 58.17, 'Nodes Impacted': 13, 'Population Impacted': 16232.0}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.97550541954473, 39.93305610729094]}, 'properties': {'ID': '179', 'impact': {'205': '10.841876195796626', '229': '13.788444236559267', '237': '12.725718331728505', '239': '13.030518331728503', '243': '12.725718331728505', '247': '11.506518331728504', '251': '7.848918331728504', '253': '6.0201183317285025', '255': '8.763318331728504'}, 'Base Demand (gpm)': 0.0, 'Nodes Impacted': 9, 'Population Impacted': 2953.0}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.96695530937815, 39.97505770562626], [-99.95960338072662, 39.97528167895033]]}, 'properties': {'ID': '180', 'impact': {'166': '0.0'}, 'Pipe Diameter (in)': 14.0, 'Nodes Impacted': 1, 'Population Impacted': 20.0}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.97447523603206, 39.93610438321538]}, 'properties': {'ID': '181', 'impact': {'166': '0.0'}, 'Base Demand (gpm)': 0.0, 'Nodes Impacted': 1, 'Population Impacted': 20.0}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.97914454467399, 39.93160767335487]}, 'properties': {'ID': '183', 'impact': {'205': '11.414561778337045', '237': '13.170339345783166', '239': '13.475139345783164', '243': '13.17033934578329', '247': '11.951139345782995', '251': '8.293539345783048', '253': '6.464739345783022', '255': '9.207939345783023'}, 'Base Demand (gpm)': 0.0, 'Nodes Impacted': 8, 'Population Impacted': 2459.0}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.99806114173452, 39.943109354255384]}, 'properties': {'ID': '187', 'impact': 'NO EFFECTED NODES', 'Base Demand (gpm)': 0.0, 'Nodes Impacted': 'NO EFFECTED NODES', 'Population Impacted': 'NO EFFECTED NODES'}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.99119479738259, 39.94503501927267]}, 'properties': {'ID': '189', 'impact': {'205': '11.400025196331399', '207': '14.03278011499352', '229': '13.508107989995048', '237': '12.445265312980752', '239': '12.75006531298075', '243': '12.445265312980752', '247': '11.22606531298075', '251': '7.56846531298075', '253': '5.739665312980749', '255': '8.482865312980751'}, 'Base Demand (gpm)': 107.92, 'Nodes Impacted': 10, 'Population Impacted': 3487.0}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-100.0079983334622, 39.973639579695195]}, 'properties': {'ID': '191', 'impact': 'NO EFFECTED NODES', 'Base Demand (gpm)': 81.9, 'Nodes Impacted': 'NO EFFECTED NODES', 'Population Impacted': 'NO EFFECTED NODES'}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.99809552155097, 39.97455712252069]}, 'properties': {'ID': '193', 'impact': {'35': '0.0'}, 'Base Demand (gpm)': 71.31, 'Nodes Impacted': 1, 'Population Impacted': 12371.0}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.88726277778879, 40.074337775189775]}, 'properties': {'ID': '20', 'impact': 'NO EFFECTED NODES', 'Base Demand (gpm)': 0.0, 'Nodes Impacted': 'NO EFFECTED NODES', 'Population Impacted': 'NO EFFECTED NODES'}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.87165888036284, 39.84903567362922]}, 'properties': {'ID': '229', 'impact': {'205': '11.400025196333925', '207': '14.03278011499715', '229': '13.508107989999969', '237': '12.445265312985619', '239': '12.750065312985617', '243': '12.445265312985619', '247': '11.226065312985618', '251': '7.568465312985618', '253': '5.7396653129856166', '255': '8.482865312985618'}, 'Base Demand (gpm)': 64.18, 'Nodes Impacted': 10, 'Population Impacted': 3487.0}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.8482329057062, 39.83584779916559]}, 'properties': {'ID': '231', 'impact': {'253': '13.86670484544633'}, 'Base Demand (gpm)': 16.48, 'Nodes Impacted': 1, 'Population Impacted': 420.0}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.9197051646007, 39.90581723631007], [-99.91591410764323, 39.9081870467193]]}, 'properties': {'ID': '233', 'impact': {'203': '0.0'}, 'Pipe Diameter (in)': 24.0, 'Nodes Impacted': 1, 'Population Impacted': 32486.0}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.87076414345465, 39.81571286546226]}, 'properties': {'ID': '243', 'impact': {'211': '0.0', '213': '0.0', '215': '0.0', '217': '0.0', '219': '0.0', '225': '0.0', '229': '0.0', '231': '0.0', '237': '0.0', '239': '0.0', '243': '0.0', '247': '0.0', '251': '0.0', '253': '0.0', '255': '0.0'}, 'Base Demand (gpm)': 4.34, 'Nodes Impacted': 15, 'Population Impacted': 4142.0}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.88908593564042, 39.87160608293155], [-99.87500005970713, 39.8749999993174]]}, 'properties': {'ID': '245', 'impact': 'NO EFFECTED NODES', 'Pipe Diameter (in)': 16.0, 'Nodes Impacted': 'NO EFFECTED NODES', 'Population Impacted': 'NO EFFECTED NODES'}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.88888466758408, 39.83840819445018]}, 'properties': {'ID': '247', 'impact': {'215': '0.0', '217': '0.0', '219': '0.0', '225': '0.0'}, 'Base Demand (gpm)': 70.38, 'Nodes Impacted': 4, 'Population Impacted': 1391.0}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.88953094606137, 39.836242300289065]}, 'properties': {'ID': '249', 'impact': {'217': '0.0', '219': '0.0', '225': '0.0'}, 'Base Demand (gpm)': 0.0, 'Nodes Impacted': 3, 'Population Impacted': 681.0}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.9016262705079, 39.83164028193637]}, 'properties': {'ID': '251', 'impact': {'219': '0.0'}, 'Base Demand (gpm)': 24.16, 'Nodes Impacted': 1, 'Population Impacted': 318.0}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.97447523603206, 39.93610438321538], [-99.97084560021605, 39.9379343966691]]}, 'properties': {'ID': '315', 'impact': 'NO EFFECTED NODES', 'Pipe Diameter (in)': 24.0, 'Nodes Impacted': 'NO EFFECTED NODES', 'Population Impacted': 'NO EFFECTED NODES'}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.96695530937815, 39.97505770562626], [-99.97066358249455, 39.96260162945918]]}, 'properties': {'ID': '321', 'impact': {'205': '10.846298330293074', '229': '13.792403187963208', '237': '12.729691688958852', '239': '13.03449168895885', '243': '12.729691688958852', '247': '11.51049168895885', '251': '7.8528916889588505', '253': '6.024091688958849', '255': '8.767291688958851'}, 'Pipe Diameter (in)': 30.0, 'Nodes Impacted': 9, 'Population Impacted': 2953.0}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.94887198404082, 40.105345703911674], [-99.95750152746828, 40.090524970752085]]}, 'properties': {'ID': '329', 'impact': {'101': '0.0', '103': '0.0', '105': '0.0', '107': '0.0', '109': '0.0', '111': '0.0', '113': '0.0', '115': '0.0', '117': '0.0', '119': '0.0', '121': '0.0', '123': '0.0', '125': '0.0', '127': '-0.7686267926324355', '131': '0.0', '139': '0.0', '141': '0.0', '143': '0.0', '145': '0.0', '147': '0.0', '149': '0.0', '15': '0.0', '151': '0.0', '153': '-3.8813971511601437', '157': '0.0', '159': '0.0', '161': '0.0', '163': '0.0', '166': '0.0', '167': '0.0', '171': '0.0', '177': '0.0', '185': '0.0', '189': '0.0', '191': '0.0', '193': '0.0', '197': '0.0', '199': '0.0', '201': '0.0', '203': '0.0', '205': '0.0', '207': '0.0', '209': '0.0', '211': '0.0', '213': '0.0', '215': '0.0', '217': '0.0', '219': '0.0', '225': '0.0', '229': '0.0', '231': '0.0', '237': '0.0', '239': '0.0', '243': '0.0', '247': '0.0', '251': '0.0', '253': '0.0', '255': '0.0', '35': '0.0'}, 'Pipe Diameter (in)': 30.0, 'Nodes Impacted': 59, 'Population Impacted': 78832.0}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.94418594042622, 40.11316571005805], [-99.95597824513047, 40.110966420393474]]}, 'properties': {'ID': '330', 'impact': 'NO EFFECTED NODES', 'Pipe Diameter (in)': 30.0, 'Nodes Impacted': 'NO EFFECTED NODES', 'Population Impacted': 'NO EFFECTED NODES'}}, {'type': 'Feature', 'geometry': {'type': 'LineString', 'coordinates': [[-99.95597824513047, 40.110966420393474], [-99.94887198404082, 40.105345703911674]]}, 'properties': {'ID': '333', 'impact': 'NO EFFECTED NODES', 'Pipe Diameter (in)': 30.0, 'Nodes Impacted': 'NO EFFECTED NODES', 'Population Impacted': 'NO EFFECTED NODES'}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.9617313530654, 39.925021992882115]}, 'properties': {'ID': '40', 'impact': 'NO EFFECTED NODES', 'Base Demand (gpm)': 0.0, 'Nodes Impacted': 'NO EFFECTED NODES', 'Population Impacted': 'NO EFFECTED NODES'}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.90983329331696, 39.85124252937452]}, 'properties': {'ID': '50', 'impact': 'NO EFFECTED NODES', 'Base Demand (gpm)': 0.0, 'Nodes Impacted': 'NO EFFECTED NODES', 'Population Impacted': 'NO EFFECTED NODES'}}, {'type': 'Feature', 'geometry': {'type': 'Point', 'coordinates': [-99.94418594042622, 40.11316571005805]}, 'properties': {'ID': '60', 'impact': {'101': '0.0', '103': '0.0', '105': '0.0', '107': '0.0', '109': '0.0', '111': '0.0', '113': '0.0', '115': '0.0', '117': '0.0', '119': '0.0', '121': '0.0', '123': '0.0', '125': '0.0', '127': '-0.7686267926338317', '131': '0.0', '139': '0.0', '141': '0.0', '143': '0.0', '145': '0.0', '147': '0.0', '149': '0.0', '15': '0.0', '151': '0.0', '153': '-3.8813971511615364', '157': '0.0', '159': '0.0', '161': '0.0', '163': '0.0', '166': '0.0', '167': '0.0', '171': '0.0', '177': '0.0', '185': '0.0', '189': '0.0', '191': '0.0', '193': '0.0', '197': '0.0', '199': '0.0', '201': '0.0', '203': '0.0', '205': '0.0', '207': '0.0', '209': '0.0', '211': '0.0', '213': '0.0', '215': '0.0', '217': '0.0', '219': '0.0', '225': '0.0', '229': '0.0', '231': '0.0', '237': '0.0', '239': '0.0', '243': '0.0', '247': '0.0', '251': '0.0', '253': '0.0', '255': '0.0', '35': '0.0'}, 'Base Demand (gpm)': 0.0, 'Nodes Impacted': 59, 'Population Impacted': 78832.0}}]},
            {
             style: function(feature){
             return colorMapCriticality(feature.properties['Population Impacted']);
             },
             onEachFeature: onEachFeature,
             filter: function(feature) {
                         if(feature.geometry.type === "LineString") return true;
             }
            }
        ).addTo(map);
        PipeCriticality.bindTooltip(tooltipBuilder, {
            tooltipFields: ['ID', 'Pipe Diameter (in)', 'Nodes Impacted', 'Population Impacted'],
            "sticky": true
        })
        .bindPopup(tooltipBuilder, {tooltipFields: ['ID', 'Pipe Diameter (in)', 'Nodes Impacted', 'Population Impacted']});
        dataLayers["Pipe Criticality"] = PipeCriticality
        PipeCriticality.remove()
             
         
    L.control.search({
        layer: wnGeojsonLayer,
        initial: true,
        propertyName: 'ID',
        moveToLocation: function(latlng, title, map) {
            var zoom = 16;
            map.setView(latlng, zoom); // access the zoom
        },
        hideMarkerOnCollapse: true,
        textPlaceholder: 'Search by ID...'
    }).addTo(map);
     
     
    L.control.layers(
        dataLayers,
        null,
        {position: 'bottomleft',
         collapsed: false,
         autoZIndex: true
        }
    ).addTo(map);
    
       
    colorMap = {}

    colorMap.x = d3.scale.linear()
        .domain([0.0, 10000.0])
        .range([0, 400]);

    colorMap.legend = L.control({position: 'topright'});
    colorMap.legend.onAdd = function (map) {var div = L.DomUtil.create('div', 'legend'); return div};
    colorMap.legend.addTo(map);

    colorMap.xAxis = d3.svg.axis()
        .scale(colorMap.x)
        .orient("top")
        .tickSize(1)
        .tickValues([0, 500, 2500, 5000, 10000]);

    colorMap.svg = d3.select(".legend.leaflet-control").append("svg")
        .attr("id", 'legend')
        .attr("width", 450)
        .attr("height", 40);
     
     colorMap.use = colorMap.svg.append("use")
        .attr("x", 25)
        .attr("y", 16)
        .attr("xlink:href", "#myRect")
        .attr("fill", "url('#myGradient')");
     
     colorMap.g = colorMap.svg.append("g")
        .attr("class", "key")
        .attr("transform", "translate(25,17)");
     
    colorMap.g.call(colorMap.xAxis).append("text")
        .attr("class", "caption")
        .attr("y", 21)
        .style("font", "14px arial")
        .text("Population Impacted By Low Pressure Conditions");
     
    L.control.scale({position:'topright'}).addTo(map);

</script>